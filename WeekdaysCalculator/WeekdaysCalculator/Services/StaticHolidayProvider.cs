using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.Json;
using System.Threading.Tasks;
using WeekdaysCalculator.Models;

namespace WeekdaysCalculator.Services
{
    public class StaticHolidayProvider : IHolidayProvider
    {
        private static string holidaysString = @"[{""Date"":""2014-04-20T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2014-06-09T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2014-10-06T00:00:00"",""Name"":""Labour Day""},{""Date"":""2015-04-05T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2015-06-08T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2015-10-05T00:00:00"",""Name"":""Labour Day""},{""Date"":""2015-12-25T00:00:00"",""Name"":""Christmas Day""},{""Date"":""2015-12-28T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2015-04-04T00:00:00"",""Name"":""Easter Saturday""},{""Date"":""2015-04-05T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2015-06-08T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2015-10-05T00:00:00"",""Name"":""Labour Day""},{""Date"":""2015-12-28T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2016-03-26T00:00:00"",""Name"":""Easter Saturday""},{""Date"":""2016-03-27T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2016-06-13T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2016-10-03T00:00:00"",""Name"":""Labour Day""},{""Date"":""2016-12-26T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2016-12-27T00:00:00"",""Name"":""Christmas Day holiday""},{""Date"":""2016-03-26T00:00:00"",""Name"":""Easter Saturday""},{""Date"":""2016-03-27T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2016-06-13T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2016-10-03T00:00:00"",""Name"":""Labour Day""},{""Date"":""2016-12-26T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2016-12-27T00:00:00"",""Name"":""Christmas Day holiday""},{""Date"":""2017-04-15T00:00:00"",""Name"":""Easter Saturday""},{""Date"":""2017-04-16T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2017-06-12T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2017-10-02T00:00:00"",""Name"":""Labour Day""},{""Date"":""2017-12-26T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2017-04-15T00:00:00"",""Name"":""Easter Saturday""},{""Date"":""2017-04-16T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2017-06-12T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2017-08-07T00:00:00"",""Name"":""Bank Holiday""},{""Date"":""2017-10-02T00:00:00"",""Name"":""Labour Day""},{""Date"":""2017-12-26T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2018-03-31T00:00:00"",""Name"":""Easter Saturday""},{""Date"":""2018-04-01T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2018-06-11T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2018-08-06T00:00:00"",""Name"":""Bank Holiday""},{""Date"":""2018-10-01T00:00:00"",""Name"":""Labour Day""},{""Date"":""2018-12-26T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2019-01-01T00:00:00"",""Name"":""New Year\u0027s Day""},{""Date"":""2019-01-28T00:00:00"",""Name"":""Australia Day""},{""Date"":""2019-04-19T00:00:00"",""Name"":""Good Friday""},{""Date"":""2019-04-20T00:00:00"",""Name"":""Saturday before Easter Sunday""},{""Date"":""2019-04-21T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2019-04-22T00:00:00"",""Name"":""Easter Monday""},{""Date"":""2019-04-25T00:00:00"",""Name"":""Anzac Day""},{""Date"":""2019-06-10T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2019-08-05T00:00:00"",""Name"":""Bank Holiday""},{""Date"":""2019-10-07T00:00:00"",""Name"":""Labour Day""},{""Date"":""2019-12-25T00:00:00"",""Name"":""Christmas Day ""},{""Date"":""2019-12-26T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2020-01-01T00:00:00"",""Name"":""New Year\u0027s Day""},{""Date"":""2020-01-27T00:00:00"",""Name"":""Australia Day""},{""Date"":""2020-04-10T00:00:00"",""Name"":""Good Friday""},{""Date"":""2020-04-11T00:00:00"",""Name"":""Easter Saturday - the Saturday following Good Friday""},{""Date"":""2020-04-12T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2020-04-13T00:00:00"",""Name"":""Easter Monday""},{""Date"":""2020-04-25T00:00:00"",""Name"":""Anzac Day""},{""Date"":""2020-06-08T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2020-08-03T00:00:00"",""Name"":""Bank Holiday""},{""Date"":""2020-10-05T00:00:00"",""Name"":""Labour Day""},{""Date"":""2020-12-25T00:00:00"",""Name"":""Christmas Day ""},{""Date"":""2020-12-26T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2020-12-28T00:00:00"",""Name"":""Boxing Day (Additional day)""},{""Date"":""2020-04-11T00:00:00"",""Name"":""Easter Saturday""},{""Date"":""2021-01-01T00:00:00"",""Name"":""New Year\u0027s Day""},{""Date"":""2021-01-26T00:00:00"",""Name"":""Australia Day""},{""Date"":""2021-04-02T00:00:00"",""Name"":""Good Friday""},{""Date"":""2021-04-03T00:00:00"",""Name"":""Easter Saturday""},{""Date"":""2021-04-04T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2021-04-05T00:00:00"",""Name"":""Easter Monday""},{""Date"":""2021-04-25T00:00:00"",""Name"":""Anzac Day""},{""Date"":""2021-06-14T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2021-08-02T00:00:00"",""Name"":""Bank Holiday""},{""Date"":""2021-10-04T00:00:00"",""Name"":""Labour Day""},{""Date"":""2021-12-25T00:00:00"",""Name"":""Christmas Day ""},{""Date"":""2021-12-26T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2021-12-27T00:00:00"",""Name"":""Christmas (additional day)""},{""Date"":""2021-12-28T00:00:00"",""Name"":""Boxing Day (additional day)""},{""Date"":""2022-01-01T00:00:00"",""Name"":""New Year\u0027s Day""},{""Date"":""2022-01-03T00:00:00"",""Name"":""New Year\u0027s Day (additional day)""},{""Date"":""2022-01-26T00:00:00"",""Name"":""Australia Day""},{""Date"":""2022-04-15T00:00:00"",""Name"":""Good Friday""},{""Date"":""2022-04-16T00:00:00"",""Name"":""Easter Saturday - the Saturday following Good Friday""},{""Date"":""2022-04-17T00:00:00"",""Name"":""Easter Sunday""},{""Date"":""2022-04-18T00:00:00"",""Name"":""Easter Monday""},{""Date"":""2022-04-25T00:00:00"",""Name"":""Anzac Day""},{""Date"":""2022-06-13T00:00:00"",""Name"":""Queen\u0027s Birthday""},{""Date"":""2022-08-01T00:00:00"",""Name"":""Bank Holiday""},{""Date"":""2022-10-03T00:00:00"",""Name"":""Labour Day""},{""Date"":""2022-12-25T00:00:00"",""Name"":""Christmas Day ""},{""Date"":""2022-12-26T00:00:00"",""Name"":""Boxing Day""},{""Date"":""2022-12-27T00:00:00"",""Name"":""Christmas (additional day)""}]";
        private static readonly List<Holiday> holidays = JsonSerializer.Deserialize<List<Holiday>>(holidaysString);

        public async Task<IEnumerable<Holiday>> GetHolidaysBetweenDates(DateTime fromDate, DateTime toDate)
        {
            var result = from holiday in holidays
                         where holiday.Date >= fromDate && holiday.Date <= toDate
                         orderby holiday.Date
                         select holiday;
                         

            return result;
        }
    }

}

